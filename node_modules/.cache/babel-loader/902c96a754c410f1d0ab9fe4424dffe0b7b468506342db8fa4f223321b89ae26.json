{"ast":null,"code":"import _slicedToArray from\"/Users/brianhardell/Desktop/UCLA/Third Year/180DB/Driver-s-Edd-Website/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// import logo from './logo.svg';\nimport'./App.css';import{db}from\"./utils/firebase\";import{onValue,onChildAdded,ref,query,orderByChild}from\"firebase/database\";import{useEffect,useState}from\"react\";import SpeedGraph from'./components/SpeedGraph';import{auth,logout}from\"./utils/firebase.js\";import{useAuthState}from\"react-firebase-hooks/auth\";import{Link,useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Dashboard(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),devices=_useState2[0],setDevices=_useState2[1];var _useAuthState=useAuthState(auth),_useAuthState2=_slicedToArray(_useAuthState,3),user=_useAuthState2[0],loading=_useAuthState2[1],error=_useAuthState2[2];var navigate=useNavigate();function DeviceButton(_ref){var data=_ref.data;var deviceInfo=function deviceInfo(){return navigate(\"/device-info\",{state:{data:data}});};return/*#__PURE__*/_jsx(\"button\",{onClick:deviceInfo,children:/*#__PURE__*/_jsx(\"p\",{children:data.deviceID})});}function RegisterButton(_ref2){var data=_ref2.data;var deviceInfo=function deviceInfo(){return navigate(\"/device-info\",{state:{data:data}});};var register=function register(){return navigate(\"/register\");};return/*#__PURE__*/_jsx(\"button\",{onClick:register,children:/*#__PURE__*/_jsx(\"p\",{children:\"Register\"})});}useEffect(function(){if(loading)return;if(!user)return navigate(\"/\");var pageQuery=query(ref(db,\"users/\"+user.uid+\"/devices\"),orderByChild('creation'));return onValue(pageQuery,function(snapshot){var data=[];if(snapshot.exists()){snapshot.forEach(function(childSnapshot){var device=childSnapshot.val();device[\"deviceID\"]=childSnapshot.key;data.push(device);});}console.log(data);setDevices(data);});},[user,loading]);return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(\"header\",{className:\"App-header\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"title\",children:\"Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{children:[devices.map(function(data){return/*#__PURE__*/_jsx(DeviceButton,{data:data,children:\" \"},data.deviceID);}),/*#__PURE__*/_jsx(RegisterButton,{children:\" \"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"logout_btn\",onClick:logout,children:\"Logout\"})]})});}export default Dashboard;","map":{"version":3,"names":["db","onValue","onChildAdded","ref","query","orderByChild","useEffect","useState","SpeedGraph","auth","logout","useAuthState","Link","useNavigate","Dashboard","devices","setDevices","user","loading","error","navigate","DeviceButton","data","deviceInfo","state","deviceID","RegisterButton","register","pageQuery","uid","snapshot","exists","forEach","childSnapshot","device","val","key","push","console","log","map"],"sources":["/Users/brianhardell/Desktop/UCLA/Third Year/180DB/Driver-s-Edd-Website/src/Dashboard.js"],"sourcesContent":["// import logo from './logo.svg';\nimport './App.css';\nimport { db } from \"./utils/firebase\";\nimport { onValue, onChildAdded,ref, query, orderByChild } from \"firebase/database\"\nimport { useEffect, useState } from \"react\";\nimport SpeedGraph from './components/SpeedGraph';\nimport {auth, logout} from \"./utils/firebase.js\"\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nfunction Dashboard() {\n\n  const [devices, setDevices] = useState([]);\n\n  const [user, loading, error] = useAuthState(auth);\n  const navigate = useNavigate();\n\n  function DeviceButton({data}){\n\n    const deviceInfo = () => {\n      return navigate(\"/device-info\", {state: {data: data}});\n    };\n  \n    return(\n        <button onClick={deviceInfo}>\n            <p>{data.deviceID}</p>\n        </button>\n    )\n    \n  }\n  \n  function RegisterButton ({data}){\n  \n    const deviceInfo = () => {\n      return navigate(\"/device-info\", {state: {data: data}});\n    };\n  \n    const register = () => {\n      return navigate(\"/register\");\n    };\n  \n    return(\n        <button onClick={register}>\n            <p>Register</p>\n        </button>\n    )\n    \n  }\n\n  useEffect(() => {\n    if (loading) return;\n    if (!user) return navigate(\"/\");\n\n    var pageQuery = query(ref(db, \"users/\" + user.uid + \"/devices\"), orderByChild('creation'));\n    \n    return onValue(pageQuery, (snapshot) => {\n\n      var data = []\n\n      if (snapshot.exists()) {\n        snapshot.forEach((childSnapshot) => {\n            var device = childSnapshot.val()\n            device[\"deviceID\"] = childSnapshot.key\n            data.push(device)\n          });\n      }\n      console.log(data)\n      setDevices(data)\n    \n    })\n  }, [user, loading]);\n\n  \n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <p className=\"title\">\n          Dashboard\n        </p>\n        <div>\n      {devices.map(data => (\n\n        <DeviceButton key={data.deviceID} data ={data}> </DeviceButton>\n      ))}\n      <RegisterButton> </RegisterButton>\n    </div>\n        <button className=\"logout_btn\" onClick={logout}>\n          Logout\n         </button>\n      </header>\n          \n    </div>\n  );\n}\n\nexport default Dashboard;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}