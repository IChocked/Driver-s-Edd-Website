{"ast":null,"code":"import _defineProperty from\"/Users/brianhardell/Desktop/UCLA/Third Year/180DB/Driver-s-Edd-Website/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/brianhardell/Desktop/UCLA/Third Year/180DB/Driver-s-Edd-Website/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/brianhardell/Desktop/UCLA/Third Year/180DB/Driver-s-Edd-Website/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// import logo from './logo.svg';\nimport'./App.css';import{db}from\"./utils/firebase\";import{onValue,onChildAdded,ref,update}from\"firebase/database\";import{useEffect,useState}from\"react\";import SpeedGraph from'./components/SpeedGraph';import{auth,logout}from\"./utils/firebase.js\";import{useAuthState}from\"react-firebase-hooks/auth\";import{Link,useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Register(){var _useAuthState=useAuthState(auth),_useAuthState2=_slicedToArray(_useAuthState,3),user=_useAuthState2[0],loading=_useAuthState2[1],error=_useAuthState2[2];var navigate=useNavigate();useEffect(function(){if(loading)return;if(!user)return navigate(\"/\");},[user,loading]);var _useState=useState({}),_useState2=_slicedToArray(_useState,2),inputs=_useState2[0],setInputs=_useState2[1];var handleChange=function handleChange(event){var name=event.target.name;var value=event.target.value;setInputs(function(values){return _objectSpread(_objectSpread({},values),{},_defineProperty({},name,value));});};var handleSubmit=function handleSubmit(event){event.preventDefault();// alert(inputs);\nregisterDevice(inputs.deviceUID);};var registerDevice=function registerDevice(deviceUID){var userID=user.uid;var dbref=ref(db,\"users/\"+userID+\"/devices/\");var time=Math.floor(Date.now()/1000);update(dbref,_defineProperty({},deviceUID,{creation:time,user:0})).then(function(){// Data saved successfully!\nalert(\"You are user 0\");}).catch(function(error){// The write failed...\nconsole.error(error);alert(error.message);});};return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(\"header\",{className:\"App-header\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"title\",children:\"Register\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Enter your device ID:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"deviceUID\",value:inputs.deviceUID||\"\",onChange:handleChange})]}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\"})]})]})});}","map":{"version":3,"names":["db","onValue","onChildAdded","ref","update","useEffect","useState","SpeedGraph","auth","logout","useAuthState","Link","useNavigate","Register","user","loading","error","navigate","inputs","setInputs","handleChange","event","name","target","value","values","handleSubmit","preventDefault","registerDevice","deviceUID","userID","uid","dbref","time","Math","floor","Date","now","creation","then","alert","catch","console","message"],"sources":["/Users/brianhardell/Desktop/UCLA/Third Year/180DB/Driver-s-Edd-Website/src/Register.js"],"sourcesContent":["// import logo from './logo.svg';\nimport './App.css';\nimport { db } from \"./utils/firebase\";\nimport { onValue, onChildAdded, ref, update } from \"firebase/database\"\nimport { useEffect, useState } from \"react\";\nimport SpeedGraph from './components/SpeedGraph';\nimport {auth, logout} from \"./utils/firebase.js\"\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nexport default function Register() {\n\n\n  const [user, loading, error] = useAuthState(auth);\n  const navigate = useNavigate();\n\n\n  useEffect(() => {\n    if (loading) return;\n    if (!user) return navigate(\"/\");\n  }, [user, loading]);\n\n  const [inputs, setInputs] = useState({});\n\n  const handleChange = (event) => {\n    const name = event.target.name;\n    const value = event.target.value;\n    setInputs(values => ({...values, [name]: value}))\n  }\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    // alert(inputs);\n    registerDevice(inputs.deviceUID)\n  }\n\n  const registerDevice = (deviceUID) => {\n    const userID = user.uid\n    const dbref = ref(db, \"users/\" + userID + \"/devices/\");\n    const time = Math.floor(Date.now()/1000)\n    update(dbref, {[deviceUID] : {creation: time, user: 0}})\n      .then(() => {\n        // Data saved successfully!\n        alert(\"You are user 0\");\n      })\n      .catch((error) => {\n        // The write failed...\n        console.error(error);\n        alert(error.message);\n      });\n  }\n\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <p className=\"title\">\n          Register\n        </p>\n        <form onSubmit={handleSubmit}>\n      <label>Enter your device ID:\n      <input \n        type=\"text\" \n        name=\"deviceUID\" \n        value={inputs.deviceUID || \"\"} \n        onChange={handleChange}\n      />\n      </label>\n        <input type=\"submit\" />\n    </form>\n\n      </header>\n    </div>\n  );\n}\n"],"mappings":"qdAAA;AACA,MAAO,WAAW,CAClB,OAASA,EAAE,KAAQ,kBAAkB,CACrC,OAASC,OAAO,CAAEC,YAAY,CAAEC,GAAG,CAAEC,MAAM,KAAQ,mBAAmB,CACtE,OAASC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,MAAOC,WAAU,KAAM,yBAAyB,CAChD,OAAQC,IAAI,CAAEC,MAAM,KAAO,qBAAqB,CAChD,OAASC,YAAY,KAAQ,2BAA2B,CACxD,OAASC,IAAI,CAAEC,WAAW,KAAQ,kBAAkB,CAAC,wFAErD,cAAe,SAASC,SAAQ,EAAG,CAGjC,kBAA+BH,YAAY,CAACF,IAAI,CAAC,gDAA1CM,IAAI,mBAAEC,OAAO,mBAAEC,KAAK,mBAC3B,GAAMC,SAAQ,CAAGL,WAAW,EAAE,CAG9BP,SAAS,CAAC,UAAM,CACd,GAAIU,OAAO,CAAE,OACb,GAAI,CAACD,IAAI,CAAE,MAAOG,SAAQ,CAAC,GAAG,CAAC,CACjC,CAAC,CAAE,CAACH,IAAI,CAAEC,OAAO,CAAC,CAAC,CAEnB,cAA4BT,QAAQ,CAAC,CAAC,CAAC,CAAC,wCAAjCY,MAAM,eAAEC,SAAS,eAExB,GAAMC,aAAY,CAAG,QAAfA,aAAY,CAAIC,KAAK,CAAK,CAC9B,GAAMC,KAAI,CAAGD,KAAK,CAACE,MAAM,CAACD,IAAI,CAC9B,GAAME,MAAK,CAAGH,KAAK,CAACE,MAAM,CAACC,KAAK,CAChCL,SAAS,CAAC,SAAAM,MAAM,wCAASA,MAAM,wBAAGH,IAAI,CAAGE,KAAK,IAAE,CAAC,CACnD,CAAC,CAED,GAAME,aAAY,CAAG,QAAfA,aAAY,CAAIL,KAAK,CAAK,CAC9BA,KAAK,CAACM,cAAc,EAAE,CACtB;AACAC,cAAc,CAACV,MAAM,CAACW,SAAS,CAAC,CAClC,CAAC,CAED,GAAMD,eAAc,CAAG,QAAjBA,eAAc,CAAIC,SAAS,CAAK,CACpC,GAAMC,OAAM,CAAGhB,IAAI,CAACiB,GAAG,CACvB,GAAMC,MAAK,CAAG7B,GAAG,CAACH,EAAE,CAAE,QAAQ,CAAG8B,MAAM,CAAG,WAAW,CAAC,CACtD,GAAMG,KAAI,CAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACC,GAAG,EAAE,CAAC,IAAI,CAAC,CACxCjC,MAAM,CAAC4B,KAAK,oBAAIH,SAAS,CAAI,CAACS,QAAQ,CAAEL,IAAI,CAAEnB,IAAI,CAAE,CAAC,CAAC,EAAE,CACrDyB,IAAI,CAAC,UAAM,CACV;AACAC,KAAK,CAAC,gBAAgB,CAAC,CACzB,CAAC,CAAC,CACDC,KAAK,CAAC,SAACzB,KAAK,CAAK,CAChB;AACA0B,OAAO,CAAC1B,KAAK,CAACA,KAAK,CAAC,CACpBwB,KAAK,CAACxB,KAAK,CAAC2B,OAAO,CAAC,CACtB,CAAC,CAAC,CACN,CAAC,CAGD,mBACE,YAAK,SAAS,CAAC,KAAK,uBAClB,gBAAQ,SAAS,CAAC,YAAY,wBAC5B,UAAG,SAAS,CAAC,OAAO,UAAC,UAErB,EAAI,cACJ,cAAM,QAAQ,CAAEjB,YAAa,wBAC/B,yBAAO,uBACP,4BACE,IAAI,CAAC,MAAM,CACX,IAAI,CAAC,WAAW,CAChB,KAAK,CAAER,MAAM,CAACW,SAAS,EAAI,EAAG,CAC9B,QAAQ,CAAET,YAAa,EACvB,GACM,cACN,cAAO,IAAI,CAAC,QAAQ,EAAG,GACpB,GAEI,EACL,CAEV"},"metadata":{},"sourceType":"module","externalDependencies":[]}