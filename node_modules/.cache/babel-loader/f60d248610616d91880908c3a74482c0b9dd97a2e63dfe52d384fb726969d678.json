{"ast":null,"code":"import _regeneratorRuntime from\"/Users/brianhardell/Desktop/UCLA/Third Year/180DB/Driver-s-Edd-Website/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/brianhardell/Desktop/UCLA/Third Year/180DB/Driver-s-Edd-Website/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";// Import the functions you need from the SDKs you need\nimport{initializeApp}from\"firebase/app\";import{getDatabase,ref,query,get,set}from\"firebase/database\";import{getAuth,signInWithPopup,GoogleAuthProvider,signOut}from\"firebase/auth\";// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n// Your web app's Firebase configuration\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\nvar firebaseConfig={apiKey:process.env.REACT_APP_FIREBASE_API_KEY,authDomain:process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,databaseURL:process.env.REACT_APP_FIREBASE_DATABASE_URL,projectId:process.env.REACT_APP_FIREBASE_PROJECT_ID,storageBucket:process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,messagingSenderId:process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,appId:process.env.REACT_APP_FIREBASE_APP_ID,measurementId:process.env.REACT_APP_FIREBASE_MEASUREMENT_ID};// Initialize Firebase\nvar app=initializeApp(firebaseConfig);//get database\nexport var db=getDatabase(app);//Enable Google Login\nexport var auth=getAuth(app);var googleProvider=new GoogleAuthProvider();export var signInWithGoogle=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,user,userID,dbref,userData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return signInWithPopup(auth,googleProvider);case 3:res=_context.sent;user=res.user;userID=user.uid;dbref=ref(db,\"users/\"+userID);_context.next=9;return get(query(dbref));case 9:userData=_context.sent;console.log(userData);if(userData.exists()){_context.next=14;break;}_context.next=14;return set(ref(db,'users/'+userID),{name:user.displayName,email:user.email});case 14:_context.next=20;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](0);console.error(_context.t0);alert(_context.t0.message);case 20:case\"end\":return _context.stop();}},_callee,null,[[0,16]]);}));return function signInWithGoogle(){return _ref.apply(this,arguments);};}();// export const signInWithGoogle = () => {\n//   signInWithPopup(auth, googleProvider).then((res) => {\n//     console.log(res.user)\n//   }).catch((error) => {\n//     console.log(error.message)\n//   })\n// }\n//allow signout\nexport var logout=function logout(){signOut(auth);};","map":{"version":3,"names":["initializeApp","getDatabase","ref","query","get","set","getAuth","signInWithPopup","GoogleAuthProvider","signOut","firebaseConfig","apiKey","process","env","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","databaseURL","REACT_APP_FIREBASE_DATABASE_URL","projectId","REACT_APP_FIREBASE_PROJECT_ID","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","messagingSenderId","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","appId","REACT_APP_FIREBASE_APP_ID","measurementId","REACT_APP_FIREBASE_MEASUREMENT_ID","app","db","auth","googleProvider","signInWithGoogle","res","user","userID","uid","dbref","userData","console","log","exists","name","displayName","email","error","alert","message","logout"],"sources":["/Users/brianhardell/Desktop/UCLA/Third Year/180DB/Driver-s-Edd-Website/src/utils/firebase.js"],"sourcesContent":["// Import the functions you need from the SDKs you need\nimport { initializeApp } from \"firebase/app\";\nimport { getDatabase, ref, query, get, set } from \"firebase/database\";\nimport {getAuth, signInWithPopup, GoogleAuthProvider, signOut} from \"firebase/auth\";\n\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Your web app's Firebase configuration\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\n\nconst firebaseConfig = {\n    apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n    authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n    databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\n    projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.REACT_APP_FIREBASE_APP_ID,\n    measurementId: process.env.REACT_APP_FIREBASE_MEASUREMENT_ID\n  };\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\n\n//get database\nexport const db = getDatabase(app);\n\n//Enable Google Login\nexport const auth = getAuth(app);\nconst googleProvider = new GoogleAuthProvider();\nexport const signInWithGoogle = async () => {\n  try {\n    const res = await signInWithPopup(auth, googleProvider);\n    const user = res.user;\n    const userID = user.uid\n    const dbref = ref(db, \"users/\" + userID );\n\n    const userData = await get(query(dbref));\n    console.log(userData)\n    if (!userData.exists()) {\n      await set(ref(db, 'users/' + userID), {\n        name: user.displayName,\n        email: user.email,\n      });\n    }\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n// export const signInWithGoogle = () => {\n//   signInWithPopup(auth, googleProvider).then((res) => {\n//     console.log(res.user)\n//   }).catch((error) => {\n//     console.log(error.message)\n//   })\n// }\n\n//allow signout\nexport const logout = () => {\n  signOut(auth);\n};\n\n\n"],"mappings":"wUAAA;AACA,OAASA,aAAa,KAAQ,cAAc,CAC5C,OAASC,WAAW,CAAEC,GAAG,CAAEC,KAAK,CAAEC,GAAG,CAAEC,GAAG,KAAQ,mBAAmB,CACrE,OAAQC,OAAO,CAAEC,eAAe,CAAEC,kBAAkB,CAAEC,OAAO,KAAO,eAAe,CAEnF;AACA;AAEA;AACA;AAEA,GAAMC,eAAc,CAAG,CACnBC,MAAM,CAAEC,OAAO,CAACC,GAAG,CAACC,0BAA0B,CAC9CC,UAAU,CAAEH,OAAO,CAACC,GAAG,CAACG,8BAA8B,CACtDC,WAAW,CAAEL,OAAO,CAACC,GAAG,CAACK,+BAA+B,CACxDC,SAAS,CAAEP,OAAO,CAACC,GAAG,CAACO,6BAA6B,CACpDC,aAAa,CAAET,OAAO,CAACC,GAAG,CAACS,iCAAiC,CAC5DC,iBAAiB,CAAEX,OAAO,CAACC,GAAG,CAACW,sCAAsC,CACrEC,KAAK,CAAEb,OAAO,CAACC,GAAG,CAACa,yBAAyB,CAC5CC,aAAa,CAAEf,OAAO,CAACC,GAAG,CAACe,iCAC7B,CAAC,CAEH;AACA,GAAMC,IAAG,CAAG7B,aAAa,CAACU,cAAc,CAAC,CAEzC;AACA,MAAO,IAAMoB,GAAE,CAAG7B,WAAW,CAAC4B,GAAG,CAAC,CAElC;AACA,MAAO,IAAME,KAAI,CAAGzB,OAAO,CAACuB,GAAG,CAAC,CAChC,GAAMG,eAAc,CAAG,GAAIxB,mBAAkB,EAAE,CAC/C,MAAO,IAAMyB,iBAAgB,4FAAG,6MAEV1B,gBAAe,CAACwB,IAAI,CAAEC,cAAc,CAAC,QAAjDE,GAAG,eACHC,IAAI,CAAGD,GAAG,CAACC,IAAI,CACfC,MAAM,CAAGD,IAAI,CAACE,GAAG,CACjBC,KAAK,CAAGpC,GAAG,CAAC4B,EAAE,CAAE,QAAQ,CAAGM,MAAM,CAAE,uBAElBhC,IAAG,CAACD,KAAK,CAACmC,KAAK,CAAC,CAAC,QAAlCC,QAAQ,eACdC,OAAO,CAACC,GAAG,CAACF,QAAQ,CAAC,IAChBA,QAAQ,CAACG,MAAM,EAAE,iDACdrC,IAAG,CAACH,GAAG,CAAC4B,EAAE,CAAE,QAAQ,CAAGM,MAAM,CAAC,CAAE,CACpCO,IAAI,CAAER,IAAI,CAACS,WAAW,CACtBC,KAAK,CAAEV,IAAI,CAACU,KACd,CAAC,CAAC,0FAGJL,OAAO,CAACM,KAAK,aAAK,CAClBC,KAAK,CAAC,YAAIC,OAAO,CAAC,CAAC,oEAEtB,kBAnBYf,iBAAgB,0CAmB5B,CACD;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA,MAAO,IAAMgB,OAAM,CAAG,QAATA,OAAM,EAAS,CAC1BxC,OAAO,CAACsB,IAAI,CAAC,CACf,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}